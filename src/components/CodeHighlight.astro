---
import { createHighlighter } from '../shiki-setup.js';

export interface Props {
  code: string;
  lang: string;
}

const { code, lang } = Astro.props;
const highlighter = await createHighlighter();
const highlightedCode = highlighter.codeToHtml(code.trim(), { lang, theme: 'nord' });
---

<div class="code-block relative font-mono text-sm">
  <pre class={`language-${lang} overflow-x-auto`}>
    <code set:html={highlightedCode} />
  </pre>
  <div class="absolute top-2 right-2">
    <span class="bg-slate-700 text-slate-300 rounded px-2 py-1 text-xs uppercase">{lang}</span>
  </div>
</div>

<style>
  .code-block {
    background-color: #2e3440; /* Nord theme background */
    color: #d8dee9; /* Nord theme text color */
    border-radius: 0.5rem;
    padding: 1rem;
    margin: 1rem 0;
  }

  .code-block pre {
    margin: 0;
    padding: 0;
  }

  /* Custom scrollbar styling */
  .code-block pre::-webkit-scrollbar {
    height: 8px;
  }

  .code-block pre::-webkit-scrollbar-thumb {
    background-color: #4c566a; /* Nord theme scrollbar color */
    border-radius: 4px;
  }

  .code-block pre::-webkit-scrollbar-track {
    background-color: #3b4252; /* Nord theme scrollbar track color */
  }

  /* Override Shiki's default styling */
  .code-block :global(pre.shiki) {
    background-color: transparent !important;
  }

  .code-block :global(pre.shiki code) {
    display: block;
    padding: 0.5rem 0;
    line-height: 1.5;
  }
</style>
